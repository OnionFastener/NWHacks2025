(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,function(e,t,a){e.exports=a(20)},,,,,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){e.exports=a.p+"static/media/robot.46fbdd56.png"},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(4),i=a.n(o),r=(a(14),a(1));a(15);var c=e=>{let{messages:t,updateMessages:o,activeChat:i}=e;const[r,c]=Object(n.useState)(""),s=Object(n.useRef)(null);Object(n.useEffect)(()=>{s.current&&(s.current.scrollTop=s.current.scrollHeight)},[t]);const m=async()=>{if(!r.trim()||!i)return;const e=[...t,{type:"user",text:r}];o(e);try{const t=await fetch("/get_response/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({text:r})}),n=await t.json();c(""),n.result&&o([...e,{type:"ai",text:n.result}])}catch(a){console.error("Error:",a)}},d=e=>e.split("\n").map((t,a)=>l.a.createElement(l.a.Fragment,{key:a},t,a!==e.split("\n").length-1&&l.a.createElement("br",null)));return l.a.createElement("div",{className:"chatbox",style:{position:"fixed",top:0,left:0,right:0,bottom:0,display:"flex",overflow:"hidden"}},l.a.createElement("div",{style:{width:"1100px",height:"100%",display:"flex",flexDirection:"column",padding:"15px",overflow:"hidden"}},l.a.createElement("div",{ref:s,className:"chat-area",style:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column",marginBottom:"15px"}},l.a.createElement("div",{style:{marginTop:"auto",display:"flex",flexDirection:"column",width:"100%"}},t.map((e,t)=>l.a.createElement("div",{key:t,style:{width:"100%",display:"flex",justifyContent:"user"===e.type?"flex-end":"flex-start",marginBottom:"10px"}},l.a.createElement("div",{className:"message ".concat(e.type,"-message"),style:{display:"inline-block",maxWidth:"70%",padding:"10px 15px",borderRadius:"10px",backgroundColor:"user"===e.type?"#0ea5e9":"#e9ecef",color:"user"===e.type?"white":"black",whiteSpace:"pre-wrap",wordBreak:"break-word",width:"fit-content",minWidth:"40px",boxSizing:"border-box"}},"ai"===e.type?l.a.createElement("div",{className:"model-response"},l.a.createElement("img",{src:a(16),alt:"AI Assistant",className:"robot-icon"}),l.a.createElement("div",{className:"response-content"},d(e.text))):d(e.text)))))),l.a.createElement("div",{style:{position:"relative",display:"flex",flexDirection:"column",gap:"10px",backgroundColor:"white",zIndex:1}},l.a.createElement("textarea",{value:r,onChange:e=>c(e.target.value),onKeyDown:e=>{(e.metaKey||e.ctrlKey)&&"Enter"===e.key&&(e.preventDefault(),m())},placeholder:"How can MediCompanion help?",style:{padding:"10px",borderRadius:"5px",border:"1px solid #ddd",minHeight:"50px",maxHeight:"200px",resize:"none",overflow:"auto",lineHeight:"1.5",fontSize:"14px"},rows:Math.min(5,r.split("\n").length||1)}))))};a(17);var s=e=>{let{togglePopup:t,showPopup:a,chatHistory:n,activeChat:o,onNewChat:i,onChatSelect:r,onDeleteChat:c}=e;const s=e=>{if(e.includes("NEW_CONDITIONS:")&&e.indexOf("NEW_CONDITIONS:")<e.indexOf("NEW_ALLERGIES:")){var t,a,n,l;const o=(null===(t=e.match(/NEW_CONDITIONS:\s*([^]+?)(?=NEW_ALLERGIES:|$)/))||void 0===t?void 0:null===(a=t[1])||void 0===a?void 0:a.trim())||"";return{allergies:(null===(n=e.match(/NEW_ALLERGIES:\s*([^]+?)$/))||void 0===n?void 0:null===(l=n[1])||void 0===l?void 0:l.trim())||"",conditions:o}}var o,i,r,c;return{allergies:(null===(o=e.match(/NEW_ALLERGIES:\s*([^]+?)(?=NEW_CONDITIONS:|$)/))||void 0===o?void 0:null===(i=o[1])||void 0===i?void 0:i.trim())||"",conditions:(null===(r=e.match(/NEW_CONDITIONS:\s*([^]+?)$/))||void 0===r?void 0:null===(c=r[1])||void 0===c?void 0:c.trim())||""}},m=e=>{const t=JSON.parse(localStorage.getItem("userMedicalData"))||{};e.allergies&&(t.allergies=t.allergies?"".concat(t.allergies,", ").concat(e.allergies):e.allergies),e.conditions&&(t.medicalConditions=t.medicalConditions?"".concat(t.medicalConditions,", ").concat(e.conditions):e.conditions),localStorage.setItem("userMedicalData",JSON.stringify(t))};return l.a.createElement("div",{className:"sidebar"},l.a.createElement("h1",{className:"app-title"},((JSON.parse(localStorage.getItem("userMedicalData"))||{}).fullName||"").split(" ")[0],"'s Health Companion"),l.a.createElement("button",{className:"action-button",onClick:()=>{(async()=>{const e=JSON.parse(localStorage.getItem("userMedicalData"))||{};try{var a;const i=await fetch("/update_card_info/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({userData:e,chatHistory:(null===(a=n.find(e=>e.id===o))||void 0===a?void 0:a.messages)||[]})}),r=await i.json();if(r.result&&"No new medical information detected."!==r.result){const e=s(r.result);m(e)}t()}catch(l){console.error("Error:",l)}})()}},a?"Close Medical ID":"Open Medical ID"),l.a.createElement("button",{className:"action-button",onClick:()=>{window.confirm("This will clear all your data and restart the app. Are you sure?")&&(localStorage.clear(),window.location.reload())},style:{backgroundColor:"#fee2e2",color:"#dc2626"}},"Reset All Data"),l.a.createElement("button",{className:"new-chat-button",onClick:i},"+ New Chat"),l.a.createElement("div",{className:"chat-history"},n.map(e=>l.a.createElement("div",{key:e.id,className:"chat-history-item ".concat(e.id===o?"active":""),onClick:()=>r(e.id)},l.a.createElement("span",{className:"chat-title"},e.title),l.a.createElement("button",{className:"delete-chat-button",onClick:t=>{t.stopPropagation(),c(e.id)}},"\xd7")))))};a(18);var m=e=>{let{onComplete:t}=e;const[a,o]=Object(n.useState)(1),[i,c]=Object(n.useState)({fullName:"",dateOfBirth:"",gender:"",height:"",weight:"",emergencyContact:"",allergies:"",medicalConditions:"",currentMedications:"",smokingStatus:"",alcoholConsumption:"",primaryConcerns:""}),s=e=>{c(Object(r.a)(Object(r.a)({},i),{},{[e.target.name]:e.target.value}))},m=e=>{e.preventDefault(),localStorage.setItem("userMedicalData",JSON.stringify(i)),t()},d=()=>o(a+1),u=()=>o(a-1);return l.a.createElement("div",{className:"onboarding-container"},l.a.createElement("div",{className:"onboarding-form"},l.a.createElement("h1",null,"Welcome to MediCompanion"),l.a.createElement("p",null,"Let's get to know you better to provide personalized medical assistance"),(()=>{switch(a){case 1:return l.a.createElement("div",{className:"form-step"},l.a.createElement("h2",null,"Basic Information"),l.a.createElement("input",{type:"text",name:"fullName",placeholder:"Full Name",value:i.fullName,onChange:s,required:!0}),l.a.createElement("input",{type:"date",name:"dateOfBirth",value:i.dateOfBirth,onChange:s,required:!0}),l.a.createElement("input",{type:"text",name:"emergencyContact",placeholder:"Emergency Contact",value:i.emergencyContact,onChange:s,required:!0}),l.a.createElement("select",{name:"gender",value:i.gender,onChange:s,required:!0},l.a.createElement("option",{value:""},"Select Gender"),l.a.createElement("option",{value:"male"},"Male"),l.a.createElement("option",{value:"female"},"Female"),l.a.createElement("option",{value:"other"},"Other")),l.a.createElement("button",{onClick:d},"Next"));case 2:return l.a.createElement("div",{className:"form-step"},l.a.createElement("h2",null,"Physical Information"),l.a.createElement("input",{type:"number",name:"height",placeholder:"Height (cm)",value:i.height,onChange:s,required:!0}),l.a.createElement("input",{type:"number",name:"weight",placeholder:"Weight (kg)",value:i.weight,onChange:s,required:!0}),l.a.createElement("button",{onClick:u},"Back"),l.a.createElement("button",{onClick:d},"Next"));case 3:return l.a.createElement("div",{className:"form-step"},l.a.createElement("h2",null,"Medical Information"),l.a.createElement("textarea",{name:"allergies",placeholder:"Known Allergies (if any)",value:i.allergies,onChange:s}),l.a.createElement("textarea",{name:"medicalConditions",placeholder:"Current Medical Conditions (if any)",value:i.medicalConditions,onChange:s}),l.a.createElement("textarea",{name:"currentMedications",placeholder:"Current Medications (if any)",value:i.currentMedications,onChange:s}),l.a.createElement("button",{onClick:u},"Back"),l.a.createElement("button",{onClick:m},"Complete"));default:return null}})()))};a(19);var d=function(){const[e,t]=Object(n.useState)([]),[a,o]=Object(n.useState)(null),[i,d]=Object(n.useState)([]),[u,p]=Object(n.useState)(!0),[g,h]=Object(n.useState)(!1),[E,f]=Object(n.useState)({name:"",dateOfBirth:"",height:"",weight:"",emergencyContact:"",allergies:"",medicalConditions:"",currentMedications:""}),v=()=>{if(!g){const e=JSON.parse(localStorage.getItem("userMedicalData"))||{};f({name:e.fullName||"Not provided",dateOfBirth:e.dateOfBirth||"Not provided",height:e.height?"".concat(e.height," cm"):"Not provided",weight:e.weight?"".concat(e.weight," kg"):"Not provided",emergencyContact:e.emergencyContact||"Not provided",allergies:e.allergies||"None reported",medicalConditions:e.medicalConditions||"None reported",currentMedications:e.currentMedications||"None reported"})}h(!g)};Object(n.useEffect)(()=>{if(localStorage.getItem("userMedicalData")){p(!1);const e=localStorage.getItem("chats");if(e){const a=JSON.parse(e);t(a),a.length>0&&(o(a[0].id),d(a[0].messages||[]))}else C()}},[]),Object(n.useEffect)(()=>{e.length>0&&localStorage.setItem("chats",JSON.stringify(e))},[e]);const C=()=>{const a={id:Date.now(),title:"Chat ".concat(e.length+1),messages:[]};t(e=>[...e,a]),o(a.id),d([])},N=t=>{const a=e.find(e=>e.id===t);a&&(o(t),d(a.messages||[]))};return l.a.createElement("div",{className:"app"},u?l.a.createElement(m,{onComplete:()=>{p(!1),C()}}):l.a.createElement(l.a.Fragment,null,l.a.createElement(s,{togglePopup:v,showPopup:g,chatHistory:e,activeChat:a,onNewChat:C,onChatSelect:N,onDeleteChat:n=>{if(t(e=>e.filter(e=>e.id!==n)),a===n){const t=e.filter(e=>e.id!==n);t.length>0?N(t[0].id):C()}}}),l.a.createElement(c,{messages:i,updateMessages:e=>{d(e),t(t=>t.map(t=>t.id===a?Object(r.a)(Object(r.a)({},t),{},{messages:e}):t))},activeChat:a}),g&&l.a.createElement("div",{className:"popup-card"},l.a.createElement("h2",null,"Medical ID"),l.a.createElement("div",{className:"popup-content"},l.a.createElement("div",{className:"info-section basic-info"},l.a.createElement("p",null,l.a.createElement("strong",null,"Name:")," ",E.name),l.a.createElement("p",null,l.a.createElement("strong",null,"Date of Birth:")," ",E.dateOfBirth),l.a.createElement("p",null,l.a.createElement("strong",null,"Height:")," ",E.height),l.a.createElement("p",null,l.a.createElement("strong",null,"Weight:")," ",E.weight),l.a.createElement("p",null,l.a.createElement("strong",null,"Emergency Contact:")," ",E.emergencyContact)),l.a.createElement("div",{className:"info-section"},l.a.createElement("h3",null,"Allergies"),l.a.createElement("p",null,E.allergies)),l.a.createElement("div",{className:"info-section"},l.a.createElement("h3",null,"Medical Conditions"),l.a.createElement("p",null,E.medicalConditions)),l.a.createElement("div",{className:"info-section"},l.a.createElement("h3",null,"Current Medications"),l.a.createElement("p",null,E.currentMedications))),l.a.createElement("button",{onClick:v},"Close"))))};i.a.createRoot(document.getElementById("root")).render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(d,null)))}],[[5,1,2]]]);
//# sourceMappingURL=main.168b07b2.chunk.js.map